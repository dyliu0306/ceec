<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <title>指考分數與分科級距對應表</title>
  <style>
    mark,
    .thick {
      padding: 0px;
      border-radius: 0px;
      background: none;
      background-color: #ffffff;
    }
    .a {
      background-color: #FFE66F;
    }
    .b {
      background-color: #FF5151;
    }
    body {
      padding: 18px;
      color: #000000;
      background-color: #ffffff;
      white-space: nowrap;
    }
    input,
    textarea {
      background-color: #272727;
    }
    .textBox {
      width: 100%;
      height: 200px;
    }
  </style>
</head>

<body>
  <div>
    <font size="6"><b>指考分數與分科級距對應表</b></font>
    <br>報錯 DC@dyliu<br>
    <select id="year">
      <option value="" selected disabled>請選擇年度</option>
      <option value="0" name='110'>110</option>
      <option value="1" name='109'>109</option>
      <option value="2" name='108'>108</option>
      <option value="3" name='107'>107</option>
      <option value="4" name='106'>106</option>
      <option value="5" name='105'>105</option>
    </select>
    <select id="sbjt">
      <option value="" selected disabled>請選擇科目</option>
      <option value="0" name='數甲'>數學甲</option>
      <option value="1" name='化學'>化學</option>
      <option value="2" name='物理'>物理</option>
      <option value="3" name='生物'>生物</option>
      <option value="4" name='歷史'>歷史</option>
      <option value="5" name='地理'>地理</option>
      <option value="5" name='公民'>公民與社會</option>
    </select>
    <button onclick="down()">確認</button><br>
    <table class="note-list" border="1">
      <tbody></tbody>
    </table>
    <br>※理論最大誤差≈0.016，內容僅供參考<br>資料來源：<a style="color: #000000;font-style:normal;"
      href="https://www.ceec.edu.tw/xmdoc?xsmsid=0J018611000723433352" target="_blank">大考中心</a>
    <br><br><br><br>
    <a style="color: #000000;font-style:normal;"
      href="https://www.ceec.edu.tw/xcepaper/cont?xsmsid=0J066588036013658199&qunit=0M105476092230875839&sid=0M165387892118130818">附錄：分科測驗級距公式<br></a>

    <img src="https://www.ceec.edu.tw/files/file_pool/1/0M165394935298462880/331-06.png" width="68%"></img><br>
    <img src="https://www.ceec.edu.tw/files/file_pool/1/0M165395076832331817/331-07.png" width="68%"></img>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <center><span id="busuanzi_container_site_pv"><font size="2">
        總瀏覽次數：<span id="busuanzi_value_site_pv"></font></span>
      </span></center>
  </div>
  <script>
    function down() {
      var year = document.getElementById("year").value;
      var yn = document.getElementById("year").name;
      var sbjt = document.getElementById("sbjt").value;
      var sn = document.getElementById("sbjt").name;
      var item = JSON.parse(json2());
      var L, num, output, pt_, t0, total, x, z1, z2, z3, text;
      a = item[year][sbjt];
      console.log(a)
      b = [];
      num = 0;
      total = 0;
      pt = 100;
      for (var i1 = 0, _pj_a = 101; i1 < _pj_a; i1 += 1) {
        if (parseInt(a[i1]) > 0) {
          for (var i2 = 0, _pj_b = parseInt(a[i1]); i2 < _pj_b; i2 += 1) {
            b[num] = pt;
            num += 1;
          }
        }
        pt -= 1;
      }
      text = ''
      t0 = Math.ceil(b.length / 100);
      roundTo = function (num, decimal) { return Math.round((num + Number.EPSILON) * Math.pow(10, decimal)) / Math.pow(10, decimal); }
      L = roundTo((sum(b.slice(0, t0)) / t0 / 60), 5)
      console.log(b.slice(0, t0).length, t0)
      z1 = 20;
      x = 0;
      z3 = 1;
      var output = document.querySelector('.note-list tbody');
      output.innerHTML = ''
      output.innerHTML = `${yn}科目${sn}總到考人數：${num}<br>級距L=${L.toFixed(5)}<br>`;
      for (var i = 0; i < 20; i += 1) {
        z2 = ((3 * z1 - x) * parseFloat(L)).toFixed(2).padStart(5, '0');
        if (z3 >= 1) {
          z2 = "100.0";
          z3 = 0;
        }
        text = `<br><b>${(3 * z1 - x).toString().padStart(2, '$')} | ${((3 * z1 - x - 1) * parseFloat(L)).toFixed(2).padStart(5, '0')}&lt;Ｘ&lt;=${z2}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${(2 * z1 - x).toString().padStart(2, '$')} | ${((2 * z1 - x - 1) * parseFloat(L)).toFixed(2).padStart(5, '0')}&lt;Ｘ&lt;=${((2 * z1 - x) * parseFloat(L)).toFixed(2).padStart(5, '0')}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${(z1 - x).toString().padStart(2, '$')} | ${((z1 - 1 - x) * parseFloat(L)).toFixed(2).padStart(5, '0')}&lt;Ｘ&lt;=${((z1 - x) * parseFloat(L)).toFixed(2).padStart(5, '0')}</b>`
        text = text.replace('$', '<font color="#ffffff">0</font>')
        output.innerHTML += text;
        x += 1;
      }

      console.log(output);

    }

    function json2() {
      return `
    [
     [
        [13,0,7,0,21,0,22,11,29,11,42,8,32,27,61,30,74,34,85,67,88,71,97,100,133,117,158,118,175,152,180,139,202,168,207,178,212,204,276,196,255,201,302,223,314,221,326,252,327,239,342,241,373,259,366,263,387,261,387,260,348,249,374,272,374,259,411,275,343,275,340,251,360,172,364,252,304,277,351,169,425,192,306,380,312,301,397,101,417,303,176,348,269,96,292,30,199,186,5,143,67],
        [1,3,5,14,8,26,27,37,55,50,86,108,108,141,138,157,215,218,215,242,239,240,288,284,280,267,286,285,283,312,283,280,255,280,256,262,272,264,273,256,270,237,240,247,256,247,210,209,236,249,228,240,228,238,226,188,227,241,224,209,202,239,205,210,244,234,228,221,267,239,245,245,253,245,268,288,268,274,260,240,292,283,242,233,209,194,179,142,97,114,105,41,43,35,18,11,10,4,3,0,3],
        [0,0,6,4,7,8,7,11,18,19,25,33,32,38,42,54,63,62,58,64,66,90,82,94,112,88,122,119,130,136,123,140,152,167,154,182,197,173,200,197,181,208,219,234,239,242,243,259,261,259,274,259,252,266,253,267,299,296,274,256,315,314,313,326,321,345,305,340,341,366,340,381,406,396,371,377,387,377,369,366,328,404,297,261,289,219,203,208,102,111,118,69,41,56,32,11,8,9,3,2,5],
        [0,0,0,1,4,11,16,28,43,79,97,108,149,185,200,167,216,244,244,245,244,243,250,251,228,236,220,232,213,224,217,214,214,181,197,212,199,182,174,218,204,202,196,189,188,206,200,177,171,162,184,191,188,193,189,191,159,174,184,181,174,164,158,175,177,179,134,157,134,142,123,141,112,131,122,94,90,92,79,58,63,48,35,30,29,23,20,10,6,6,1,0,2,0,1,0,0,0,0,0,4],
        [0,4,19,17,31,65,105,130,143,214,248,278,319,339,382,427,440,461,505,498,491,533,508,500,489,476,473,473,462,472,398,405,405,406,441,379,354,332,357,363,350,316,306,296,287,281,283,233,254,261,232,195,203,191,172,181,135,148,145,121,106,94,96,88,101,82,67,66,60,55,44,43,41,30,32,26,22,18,19,16,15,13,8,8,7,2,3,5,1,3,0,1,1,0,0,0,0,0,0,0,2],
        [0,0,6,0,19,0,56,0,110,0,182,0,317,0,376,0,476,0,575,0,658,0,703,0,745,0,811,0,815,0,864,0,782,0,754,0,831,0,747,0,802,0,722,0,746,0,727,0,719,0,633,0,599,0,550,0,491,0,449,0,403,0,337,0,295,0,226,0,188,0,148,0,109,0,89,0,53,0,45,0,37,0,26,0,13,0,6,0,2,0,2,0,0,0,0,0,0,0,0,0,1],
        [0,0,0,1,1,0,3,5,7,10,33,15,39,30,59,60,116,64,164,119,174,161,242,171,305,210,342,247,344,289,380,281,420,316,470,299,498,332,474,336,507,344,526,313,573,336,551,345,532,334,547,325,517,332,475,258,435,256,400,226,312,206,285,178,265,130,181,88,140,89,81,53,65,33,40,29,37,16,15,5,12,10,9,3,3,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,1]
      ],
      [
        [0,0,0,0,2,0,4,8,4,6,8,12,19,16,25,28,33,33,36,25,49,45,52,40,84,61,91,75,117,76,138,89,149,124,199,140,189,146,256,154,276,194,285,206,286,240,325,232,363,251,391,258,434,288,443,313,466,317,433,315,426,312,476,296,484,300,450,318,513,324,441,307,485,296,450,296,418,329,456,270,429,275,383,349,393,247,399,235,358,313,240,264,256,151,235,120,103,155,36,86,46],
        [32,15,79,55,136,108,154,187,188,207,229,275,243,259,267,282,268,263,257,313,299,262,275,290,255,264,291,269,291,270,263,276,248,281,267,268,278,257,248,270,264,242,249,235,251,222,269,227,233,231,217,234,227,242,231,211,239,219,225,211,236,228,213,258,274,240,243,243,266,249,235,260,228,234,234,288,214,250,210,187,180,166,178,158,145,115,82,96,54,47,56,25,22,23,12,4,7,4,2,1,3],
        [8,6,6,16,23,30,31,44,48,57,86,103,113,101,113,123,137,139,156,166,160,174,162,178,196,200,190,205,227,215,206,263,219,222,231,234,257,237,214,243,239,265,251,240,240,229,238,231,225,245,231,243,236,244,246,260,238,233,275,245,266,273,265,225,272,274,252,263,275,316,336,309,309,333,359,386,326,328,354,347,322,311,243,246,266,196,180,129,123,97,75,43,44,30,9,9,4,3,3,1,10],
        [0,0,0,0,0,0,0,3,0,4,11,11,20,30,48,55,87,118,113,140,157,176,178,198,224,217,215,258,264,233,257,239,239,242,276,230,226,245,213,233,232,233,225,221,222,214,225,224,200,222,264,247,214,246,249,245,229,197,240,218,231,234,206,222,217,205,216,192,200,179,172,180,159,152,133,123,110,92,105,79,76,79,65,40,50,34,27,12,11,11,3,1,1,4,0,0,0,0,0,0,1],
        [0,0,0,0,1,0,1,1,4,14,23,17,28,63,74,86,125,146,172,206,227,268,306,314,319,349,414,431,427,458,417,462,470,484,500,472,502,488,447,515,462,457,451,457,454,429,450,441,462,427,414,394,401,368,386,365,365,348,328,326,299,277,270,261,243,228,226,203,230,155,155,133,128,106,108,81,86,71,55,40,42,33,29,23,26,8,10,4,8,1,3,1,1,0,0,0,0,0,0,0,3],
        [0,0,0,0,0,0,8,0,15,0,48,0,109,0,183,0,252,0,405,0,533,0,598,0,712,0,712,0,826,0,937,0,917,0,928,0,963,0,913,0,996,0,951,0,984,0,929,0,852,0,835,0,670,0,704,0,691,0,573,0,490,0,413,0,391,0,327,0,274,0,174,0,152,0,117,0,98,0,52,0,33,0,30,0,13,0,9,0,3,0,0,0,1,0,1,0,0,0,0,0,4],
        [0,0,0,0,1,0,2,1,11,12,27,25,44,42,95,88,147,135,224,159,298,218,373,278,429,341,460,365,554,381,572,382,553,438,593,387,637,437,608,383,636,364,572,413,580,368,535,339,495,337,485,314,462,252,351,220,335,182,251,137,208,132,184,114,138,89,140,86,107,49,73,43,62,38,54,28,41,14,36,12,16,1,13,4,3,0,2,0,0,0,1,0,0,0,0,0,0,0,0,0,7]
      ]
    ]
     `
    }

    function sum(arr) {
      var sum = 0;
      arr.forEach(function (element) {
        sum += element;
      });
      return sum;
    }
  </script>
</body>

</html>
